<%- include('../partials/layout-header', { title: 'Pilóták Kezelése' }) %>
<% 
    // BIZTONSÁGI VÁLTOZÓK (Ha véletlenül nem jönnének a szervertől)
    const q = (typeof query !== 'undefined') ? query : {}; 
    const nats = (typeof nationalities !== 'undefined') ? nationalities : [];
%>
<div class="content-section">
    <div class="container">
        <div class="hero-section"><h1 class="hero-title">Jelenlegi Pilóták</h1></div>
        <div class="text-end mb-3"><a href="/pilots/create" class="btn btn-f1">Új Pilóta +</a></div>
        <div class="card-f1">
            <form class="d-flex gap-2 mb-3" method="GET">
                <input name="search" class="form-control w-auto" placeholder="Keresés..." value="<%= q.search || '' %>">
                <select name="nationality" class="form-control w-auto">
                    <option value="">Minden</option>
                    <% nats.forEach(n=>{ %>
                        <option value="<%= n %>" <%= q.nationality==n?'selected':'' %>><%= n %></option>
                    <% }) %>
                </select>
                <button class="btn btn-f1">Szűr</button>
            </form>
            <table class="table table-f1">
                <thead><tr><th>Név</th><th>Csapat</th><th>Művelet</th></tr></thead>
                <tbody>
                    <% pilots.forEach(p => { %>
                        <tr>
                            <td><strong><%= p.name %></strong></td>
                            <td><%= p.team || '-' %></td>
                            <td>
                                <a href="/pilots/show/<%= p.pilot_id %>" class="btn btn-sm btn-info text-white">Info</a>
                                <a href="/pilots/edit/<%= p.pilot_id %>" class="btn btn-sm btn-warning">Szerk</a>
                                <form action="/pilots/delete/<%= p.pilot_id %>" method="POST" style="display:inline" onsubmit="return confirm('Biztos?')">
                                    <button class="btn btn-sm btn-danger">Töröl</button>
                                </form>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
            <%- include('../partials/pagination', {currentPage, totalPages, queryParams}) %>
        </div>
    </div>
</div>
<%- include('../partials/layout-footer') %>