<%- include('../partials/header', { title: 'Pilóták Kezelése' }) %>

<!-- Fő keret a térközhöz (ez tolja le a menü alól) -->
<div id="main" class="wrapper style1">
    <div class="container">
        
        <!-- 1. Címsor doboz (Sötét üveg) -->
        <div class="hero-section">
            <h1 class="hero-title">Jelenlegi Pilóták</h1>
        </div>

        <div class="text-end mb-3">
            <a href="<%= baseUrl %>/pilots/create" class="button primary small">Új Pilóta +</a>
        </div>

        <!-- 2. Tartalom doboz (Sötét üveg) -->
        <div class="card-f1">
            <!-- Kereső és Szűrő -->
            <form class="d-flex gap-2 mb-3" method="GET" action="<%= baseUrl %>/pilots" style="margin: 0;">
                <div class="row gtr-uniform" style="width: 100%;">
                    <div class="col-4 col-12-small">
                        <input name="search" class="form-control" placeholder="Keresés..." value="<%= (typeof query !== 'undefined' && query.search) ? query.search : '' %>" style="background: rgba(0,0,0,0.3); border-color: #555; color: white;">
                    </div>
                    <div class="col-4 col-12-small">
                        <select name="nationality" class="form-control" style="background: rgba(0,0,0,0.3); border-color: #555; color: white;">
                            <option value="" style="background: #333;">Minden nemzetiség</option>
                            <% if(typeof nationalities !== 'undefined') { %>
                                <% nationalities.forEach(n => { %>
                                    <option value="<%= n %>" style="background: #333;" <%= (typeof query !== 'undefined' && query.nationality == n) ? 'selected' : '' %>><%= n %></option>
                                <% }) %>
                            <% } %>
                        </select>
                    </div>
                    <div class="col-4 col-12-small">
                        <button class="button primary fit small">Szűr</button>
                    </div>
                </div>
            </form>

            <hr style="border-color: rgba(255,255,255,0.1);">

            <!-- Táblázat -->
            <div class="table-responsive">
                <table class="table table-f1">
                    <thead>
                        <tr>
                            <th>Név</th>
                            <th>Csapat</th>
                            <th>Nemzetiség</th>
                            <th style="text-align: center;">Művelet</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if(pilots.length > 0) { %>
                           <% pilots.forEach(p => { %>
                            <tr>
                          
                                <td><strong><%= p.name %></strong> <span style="font-size: 0.8em; color: #888;">(#<%= p.pilot_id %>)</span></td> 
                                <td>
                                    <span class="badge" style="background: #e10600; color: white;"><%= p.team || '-' %></span>
                                </td>
                                <td><%= p.nationality %></td>
                                <td style="text-align: center;">
                               
                                    
                                    <a href="<%= baseUrl %>/pilots/<%= p.pilot_id %>" class="button small">Info</a>
                                    
                                    <a href="<%= baseUrl %>/pilots/edit/<%= p.pilot_id %>" class="button small">Szerk</a>
                                    
                                    <form action="<%= baseUrl %>/pilots/delete/<%= p.pilot_id %>" method="POST" style="display:inline" onsubmit="return confirm('Biztosan törlöd <%= p.name %>-t?')">
                                        <button class="button small alt">Töröl</button>
                                    </form>
                                </td>
                            </tr>
                        <% }) %>
                        <% } else { %>
                            <tr>
                                <td colspan="4" class="text-center">Nincs találat.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- Tartalom doboz vége -->

    </div>
</div>

<%- include('../partials/footer') %>